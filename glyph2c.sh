#!/bin/bash

##================================================================================================================
doit () {
	file=$1
	hdr=$2
	last=$3
	((last--))

	cnt=0  ## Array index
	n=0    ## Line counter

	while read -r l ; do         ## Read a line
		[[ -z $l ]] && continue  ## Ignore empty lines

		eval "bits${n}=(\$l)"      ## Get a full line of bits
		((++n < 10)) && continue   ## ...until we have 10 lines

		for ((col = 0;  col < 16;  col++)) ; do  ##   Max 16 glyphs per line
			[[ -z ${bits0[$col]} ]] && continue  ##     Ignore unused chars

			chr=$(case "$cnt" in                 ##     Find chr value
				("95")  echo 255 ;;              ##       ...
				("96")  echo 163 ;;              ##       ...
				("97")  echo 223 ;;              ##       ...
				("98")  echo 224 ;;              ##       ...
				(*   )  echo $((cnt + 32)) ;;    ##       ...
			esac)                                ##       ...
			printf -v chrx "0x%02X" $chr         ##     Convert to chr value hex

			## Start array for this glyph
			echo -en "\t\t{ // -------------------------[$cnt] -> chr($chr) = $chrx\n\t\t"
			for ((row = 0;  row < 10;  row++)) ; do            ## 10 rows
				eval "x=\${bits$row[$col]}"                    ## Get a row

				val=0                                          ## Calculate value
				for ((bit = 0;  bit < 6;  bit++)); do          ## 6 bits per line
					((val <<= 1))                              ##   Make way for new bit
					[[ "${x:bit:1}" != "." ]] && ((val |= 1))  ##   Add bit in (if present)
				done                                           ## .
				printf -v valx "0x%02X" $val                   ## Get hex value

				if ((row == 9)) ; then                         ## Last row of glyph?
					echo -en "  $valx  /* $x */\n\t\t}"        ##   No comma after value; close array
					((cnt != $last)) && echo -e ","            ##   NOT the last glyph? .. Append a comma
				else                                           ## Glyph row 0..8
					echo -en "  $valx, /* $x */\n\t\t"         ##   Comma after value; leave array open
				fi                                             ## .
			done
			((cnt++))                                          ## Next glyph
		done
		n=0
	done < <(sed -n "/^\*\*+${hdr}.*/,/^\*\*-${hdr}/p" ${file}  | sed '1d;$d')
}

##================================================================================================================
## ENTRY POINT
##
echo "uint8_t  glyph[2][(6 *16) +3][10] = {"

echo -e "\t{ // Alphanumeric Glyphs ======================================="
doit $0 ALPHA $(((6 *16) +3))
echo -e "\n\t},"

echo -e "\t{ // Graphics Glyphs ==========================================="
doit $0 GRAPHIC $(((6 *16) +3))
echo -e "\n\t}"

echo "};"

exit 0

##================================================================================================================
## Here come the glyphs - dood'an'doo'doo
##
**+ALPHA
......  ...#..  ..#.#.  ..#.#.  ..###.  .##...  ..#...  ...#..  ....#.  ..#...  ...#..  ......  ......  ......  ......  ......
......  ...#..  ..#.#.  ..#.#.  .#.#.#  .##..#  .#.#..  ...#..  ...#..  ...#..  .#.#.#  ...#..  ......  ......  ......  ......
......  ...#..  ..#.#.  .#####  .#.#..  ....#.  .#.#..  ...#..  ..#...  ....#.  ..###.  ...#..  ......  ......  ......  .....#
......  ...#..  ......  ..#.#.  ..###.  ...#..  ..#...  ......  ..#...  ....#.  ...#..  .#####  ......  ..###.  ......  ....#.
......  ...#..  ......  .#####  ...#.#  ..#...  .#.#.#  ......  ..#...  ....#.  ..###.  ...#..  ......  ......  ......  ...#..
......  ......  ......  ..#.#.  .#.#.#  .#..##  .#..#.  ......  ...#..  ...#..  .#.#.#  ...#..  ...#..  ......  ......  ..#...
......  ...#..  ......  ..#.#.  ..###.  ....##  ..##.#  ......  ....#.  ..#...  ...#..  ......  ...#..  ......  ...#..  .#....
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ..#...  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......

...#..  ...#..  ..###.  .#####  ....#.  .#####  ...##.  .#####  ..###.  ..###.  ......  ......  ....#.  ......  .#....  ..###.
..#.#.  ..##..  .#...#  .....#  ...##.  .#....  ..#...  .....#  .#...#  .#...#  ......  ......  ...#..  ......  ..#...  .#...#
.#...#  ...#..  .....#  ....#.  ..#.#.  .####.  .#....  ....#.  .#...#  .#...#  ...#..  ...#..  ..#...  .#####  ...#..  ....#.
.#...#  ...#..  ...##.  ...##.  .#..#.  .....#  .####.  ...#..  ..###.  ..####  ......  ......  .#....  ......  ....#.  ...#..
.#...#  ...#..  ..#...  .....#  .#####  .....#  .#...#  ..#...  .#...#  .....#  ......  ......  ..#...  .#####  ...#..  ...#..
..#.#.  ...#..  .#....  .#...#  ....#.  .#...#  .#...#  ..#...  .#...#  ....#.  ......  ...#..  ...#..  ......  ..#...  ......
...#..  ..###.  .#####  ..###.  ....#.  ..###.  ..###.  ..#...  ..###.  ..##..  ...#..  ...#..  ....#.  ......  .#....  ...#..
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ..#...  ......  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......

..###.  ...#..  .####.  ..###.  .####.  .#####  .#####  ..###.  .#...#  ..###.  .....#  .#...#  .#....  .#...#  .#...#  ..###.
.#...#  ..#.#.  .#...#  .#...#  .#...#  .#....  .#....  .#...#  .#...#  ...#..  .....#  .#..#.  .#....  .##.##  .#...#  .#...#
.#.###  .#...#  .#...#  .#....  .#...#  .#....  .#....  .#....  .#...#  ...#..  .....#  .#.#..  .#....  .#.#.#  .##..#  .#...#
.#.#.#  .#...#  .####.  .#....  .#...#  .####.  .####.  .#....  .#####  ...#..  .....#  .##...  .#....  .#...#  .#.#.#  .#...#
.#.###  .#####  .#...#  .#....  .#...#  .#....  .#....  .#..##  .#...#  ...#..  .....#  .#.#..  .#....  .#...#  .#..##  .#...#
.#....  .#...#  .#...#  .#...#  .#...#  .#....  .#....  .#...#  .#...#  ...#..  .#...#  .#..#.  .#....  .#...#  .#...#  .#...#
..###.  .#...#  .####.  ..###.  .####.  .#####  .#....  ..####  .#...#  ..###.  ..###.  .#...#  .#####  .#...#  .#...#  ..###.
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......

.####.  ..###.  .####.  ..###.  .#####  .#...#  .#...#  .#...#  .#...#  .#...#  .#####  ......  .#....  ......  ......  ......
.#...#  .#...#  .#...#  .#...#  ...#..  .#...#  .#...#  .#...#  .#...#  .#...#  .....#  ...#..  .#....  ...#..  ...#..  ......
.#...#  .#...#  .#...#  .#....  ...#..  .#...#  .#...#  .#...#  ..#.#.  ..#.#.  ....#.  ..#...  .#....  ....#.  ..###.  ......
.####.  .#...#  .####.  ..###.  ...#..  .#...#  ..#.#.  .#...#  ...#..  ...#..  ...#..  .#####  .#....  .#####  .#.#.#  .#####
.#....  .#.#.#  .#.#..  .....#  ...#..  .#...#  ..#.#.  .#.#.#  ..#.#.  ...#..  ..#...  ..#...  .#.##.  ....#.  ...#..  ......
.#....  .#..#.  .#..#.  .#...#  ...#..  .#...#  ...#..  .##.##  .#...#  ...#..  .#....  ...#..  .....#  ...#..  ...#..  ......
.#....  ..##.#  .#...#  ..###.  ...#..  ..###.  ...#..  ..#.#.  .#...#  ...#..  .#####  ......  ....#.  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ...#..  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ...###  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......

...##.  ......  .#....  ......  .....#  ......  ....#.  ......  .#....  ...#..  ...#..  ..#...  ..##..  ......  ......  ......
..#..#  ......  .#....  ......  .....#  ......  ...#..  ......  .#....  ......  ......  ..#...  ...#..  ......  ......  ......
..#...  ..###.  .####.  ..####  ..####  ..###.  ...#..  ..####  .####.  ..##..  ...#..  ..#..#  ...#..  .##.#.  .####.  ..###.
.###..  .....#  .#...#  .#....  .#...#  .#...#  ..###.  .#...#  .#...#  ...#..  ...#..  ..#.#.  ...#..  .#.#.#  .#...#  .#...#
..#...  ..####  .#...#  .#....  .#...#  .#####  ...#..  .#...#  .#...#  ...#..  ...#..  ..##..  ...#..  .#.#.#  .#...#  .#...#
..#...  .#...#  .#...#  .#....  .#...#  .#....  ...#..  .#...#  .#...#  ...#..  ...#..  ..#.#.  ...#..  .#.#.#  .#...#  .#...#
.#####  ..####  .####.  ..####  ..####  ..###.  ...#..  ..####  .#...#  ..###.  ...#..  ..#..#  ..###.  .#.#.#  .#...#  ..###.
......  ......  ......  ......  ......  ......  ......  .....#  ......  ......  ...#..  ......  ......  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ..###.  ......  ......  ..#...  ......  ......  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......

......  ......  ......  ......  ...#..  ......  ......  ......  ......  ......  ......  .#....  ..#.#.  .##...  ......  .#####
......  ......  ......  ......  ...#..  ......  ......  ......  ......  ......  ......  .#....  ..#.#.  ...#..  ...#..  .#####
.####.  ..####  ..#.##  ..####  ..###.  .#...#  .#...#  .#...#  .#...#  .#...#  .#####  .#....  ..#.#.  .##...  ......  .#####
.#...#  .#...#  ..##..  .#....  ...#..  .#...#  .#...#  .#...#  ..#.#.  .#...#  ....#.  .#....  ..#.#.  ...#..  .#####  .#####
.#...#  .#...#  ..#...  ..###.  ...#..  .#...#  ..#.#.  .#.#.#  ...#..  .#...#  ...#..  .#...#  ..#.#.  .##..#  ......  .#####
.#...#  .#...#  ..#...  .....#  ...#..  .#...#  ..#.#.  .#.#.#  ..#.#.  .#...#  ..#...  ....##  ..#.#.  ....##  ...#..  .#####
.####.  ..####  ..#...  .####.  ....#.  ..####  ...#..  ..#.#.  .#...#  ..####  .#####  ...#.#  ..#.#.  ...#.#  ......  .#####
.#....  .....#  ......  ......  ......  ......  ......  ......  ......  .....#  ......  ...###  ......  ...###  ......  ......
.#....  .....#  ......  ......  ......  ......  ......  ......  ......  ..###.  ......  .....#  ......  .....#  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......

...##.  ..#.#.  ......
..#..#  ..#.#.  ......
..#...  .#####  ......
.###..  ..#.#.  .#####
..#...  .#####  ......
..#...  ..#.#.  ......
.#####  ..#.#.  ......
......  ......  ......
......  ......  ......
......  ......  ......
**-ALPHA

**+GRAPHIC
......  ###...  ...###  ..#.#.  ......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######
......  ###...  ...###  ..#.#.  ......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######
......  ###...  ...###  .#####  ......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######
......  ......  ......  ..#.#.  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ......  ......  .#####  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ......  ......  ..#.#.  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ......  ......  ..#.#.  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......

......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######
......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######
......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######
......  ......  ......  ......  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ......  ......  ......  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ......  ......  ......  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ......  ......  ......  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...
###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...
###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...  ###...

..###.  ...#..  .####.  ..###.  .####.  .#####  .#####  ..###.  .#...#  ..###.  .....#  .#...#  .#....  .#...#  .#...#  ..###.
.#...#  ..#.#.  .#...#  .#...#  .#...#  .#....  .#....  .#...#  .#...#  ...#..  .....#  .#..#.  .#....  .##.##  .#...#  .#...#
.#.###  .#...#  .#...#  .#....  .#...#  .#....  .#....  .#....  .#...#  ...#..  .....#  .#.#..  .#....  .#.#.#  .##..#  .#...#
.#.#.#  .#...#  .####.  .#....  .#...#  .####.  .####.  .#....  .#####  ...#..  .....#  .##...  .#....  .#...#  .#.#.#  .#...#
.#.###  .#####  .#...#  .#....  .#...#  .#....  .#....  .#..##  .#...#  ...#..  .....#  .#.#..  .#....  .#...#  .#..##  .#...#
.#....  .#...#  .#...#  .#...#  .#...#  .#....  .#....  .#...#  .#...#  ...#..  .#...#  .#..#.  .#....  .#...#  .#...#  .#...#
..###.  .#...#  .####.  ..###.  .####.  .#####  .#....  ..####  .#...#  ..###.  ..###.  .#...#  .#####  .#...#  .#...#  ..###.
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......

.####.  ..###.  .####.  ..###.  .#####  .#...#  .#...#  .#...#  .#...#  .#...#  .#####  ......  .#....  ......  ......  ......
.#...#  .#...#  .#...#  .#...#  ...#..  .#...#  .#...#  .#...#  .#...#  .#...#  .....#  ...#..  .#....  ...#..  ...#..  ......
.#...#  .#...#  .#...#  .#....  ...#..  .#...#  .#...#  .#...#  ..#.#.  ..#.#.  ....#.  ..#...  .#....  ....#.  ..###.  ......
.####.  .#...#  .####.  ..###.  ...#..  .#...#  ..#.#.  .#...#  ...#..  ...#..  ...#..  .#####  .#....  .#####  .#.#.#  ......
.#....  .#.#.#  .#.#..  .....#  ...#..  .#...#  ..#.#.  .#.#.#  ..#.#.  ...#..  ..#...  ..#...  .#.##.  ....#.  ...#..  ......
.#....  .#..#.  .#..#.  .#...#  ...#..  .#...#  ...#..  .##.##  .#...#  ...#..  .#....  ...#..  .....#  ...#..  ...#..  ......
.#....  ..##.#  .#...#  ..###.  ...#..  ..###.  ...#..  ..#.#.  .#...#  ...#..  .#####  ......  ....#.  ......  ......  ......
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ...#..  ......  ......  ...###
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ...###  ......  ......  ...###
......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ......  ...###

######  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######
######  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######
######  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######
......  ......  ......  ......  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ......  ......  ......  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ......  ......  ......  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ......  ......  ......  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###
......  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###
......  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###  ...###

......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######
......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######
......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######  ......  ###...  ...###  ######
......  ......  ......  ......  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ......  ......  ......  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ......  ......  ......  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
......  ......  ......  ......  ###...  ###...  ###...  ###...  ...###  ...###  ...###  ...###  ######  ######  ######  ######
######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######
######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######
######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######  ######

######  ..#.#.  ......
######  ..#.#.  ......
######  .#####  ......
......  ..#.#.  ......
......  .#####  ......
......  ..#.#.  ......
......  ..#.#.  ......
......  ......  ...###
......  ......  ...###
......  ......  ...###
**-GRAPHIC
